{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useCatalogoPermisos.js\nimport { useEffect, useMemo, useState } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { PERMISOS as PERMISOS_LOCAL, ETIQUETAS_PERMISOS } from '../constants/permissions';\n\n// Hook en espa침ol para obtener y normalizar el cat치logo de permisos\n// Devuelve: { ids, etiquetas, loading, error, refrescar }\nexport default function useCatalogoPermisos() {\n  _s();\n  const {\n    authFetch\n  } = useAuth();\n  const [ids, setIds] = useState(PERMISOS_LOCAL);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  useEffect(() => {\n    let cancelado = false;\n    const cargar = async () => {\n      try {\n        setLoading(true);\n        setError('');\n        const resp = await authFetch('http://localhost:5000/api/permissions');\n        if (!resp.ok) return; // fallback a locales\n        const data = await resp.json();\n        if (!cancelado && Array.isArray(data.permissions)) {\n          const norm = data.permissions.map(p => typeof p === 'string' ? p : p && (p.id || p.name) || '').filter(Boolean);\n          setIds(norm);\n        }\n      } catch (e) {\n        // fallback silencioso\n      } finally {\n        if (!cancelado) setLoading(false);\n      }\n    };\n    cargar();\n    return () => {\n      cancelado = true;\n    };\n  }, [authFetch]);\n  const etiquetas = useMemo(() => {\n    const map = {};\n    ids.forEach(id => {\n      map[id] = ETIQUETAS_PERMISOS[id] || id;\n    });\n    return map;\n  }, [ids]);\n  const refrescar = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      const resp = await authFetch('http://localhost:5000/api/permissions');\n      if (!resp.ok) return {\n        success: false\n      };\n      const data = await resp.json();\n      if (Array.isArray(data.permissions)) {\n        const norm = data.permissions.map(p => typeof p === 'string' ? p : p && (p.id || p.name) || '').filter(Boolean);\n        setIds(norm);\n      }\n      return {\n        success: true\n      };\n    } catch (e) {\n      setError(e.message || 'Error cargando permisos');\n      return {\n        success: false,\n        error: e.message\n      };\n    } finally {\n      setLoading(false);\n    }\n  };\n  return {\n    ids,\n    etiquetas,\n    loading,\n    error,\n    refrescar\n  };\n}\n_s(useCatalogoPermisos, \"xtfn29RQYCRHWlAECRzxZ+x/aeo=\", false, function () {\n  return [useAuth];\n});","map":{"version":3,"names":["useEffect","useMemo","useState","useAuth","PERMISOS","PERMISOS_LOCAL","ETIQUETAS_PERMISOS","useCatalogoPermisos","_s","authFetch","ids","setIds","loading","setLoading","error","setError","cancelado","cargar","resp","ok","data","json","Array","isArray","permissions","norm","map","p","id","name","filter","Boolean","e","etiquetas","forEach","refrescar","success","message"],"sources":["D:/Usuarios/FRANCO/Desktop/parroquav3/frontend/src/hooks/useCatalogoPermisos.js"],"sourcesContent":["// src/hooks/useCatalogoPermisos.js\nimport { useEffect, useMemo, useState } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { PERMISOS as PERMISOS_LOCAL, ETIQUETAS_PERMISOS } from '../constants/permissions';\n\n// Hook en espa침ol para obtener y normalizar el cat치logo de permisos\n// Devuelve: { ids, etiquetas, loading, error, refrescar }\nexport default function useCatalogoPermisos() {\n  const { authFetch } = useAuth();\n  const [ids, setIds] = useState(PERMISOS_LOCAL);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    let cancelado = false;\n    const cargar = async () => {\n      try {\n        setLoading(true);\n        setError('');\n        const resp = await authFetch('http://localhost:5000/api/permissions');\n        if (!resp.ok) return; // fallback a locales\n        const data = await resp.json();\n        if (!cancelado && Array.isArray(data.permissions)) {\n          const norm = data.permissions\n            .map((p) => (typeof p === 'string' ? p : (p && (p.id || p.name)) || ''))\n            .filter(Boolean);\n          setIds(norm);\n        }\n      } catch (e) {\n        // fallback silencioso\n      } finally {\n        if (!cancelado) setLoading(false);\n      }\n    };\n    cargar();\n    return () => { cancelado = true; };\n  }, [authFetch]);\n\n  const etiquetas = useMemo(() => {\n    const map = {};\n    ids.forEach((id) => { map[id] = ETIQUETAS_PERMISOS[id] || id; });\n    return map;\n  }, [ids]);\n\n  const refrescar = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      const resp = await authFetch('http://localhost:5000/api/permissions');\n      if (!resp.ok) return { success: false };\n      const data = await resp.json();\n      if (Array.isArray(data.permissions)) {\n        const norm = data.permissions\n          .map((p) => (typeof p === 'string' ? p : (p && (p.id || p.name)) || ''))\n          .filter(Boolean);\n        setIds(norm);\n      }\n      return { success: true };\n    } catch (e) {\n      setError(e.message || 'Error cargando permisos');\n      return { success: false, error: e.message };\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return { ids, etiquetas, loading, error, refrescar };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}